Описание алгоритма двухфакторной авторизации на сайте:

1. Проверка полей формы, в которые пользователь вводит логин и пароль на пустоту
с помощью функции is_not_empty(string $field): bool. Если вернулось true, то есть оба поля не пустые, то переходим ко второму шагу,
иначе возвращется строка, сообщающая, что оба поля должны быть заполнены.

2. Поиск логина в базе данных c помощью функции check_login(string $login): bool.
Если логин существует, то функция возвращает true и происходит переход к следующему шагу, иначе возвращется строка - 'пользователя с таким логином не существует'

3. Вызов функции check_password(string $login): bool, если функция вернула true, то логин с таким паролем найден в базе данных и происходит переход к следующему шагу, иначе возвращается строка - 'неправильный пароль'.

4. Вызов функции send_code(). Внутри функции send_code() вызывается функция generate_code(), которая возвращает строку определенной заранее длины - код. Отправка кода на почту/телефон пользователя. 
Перед отправкой код сохраняется в базу данных в специальное поле.

5 Появление на странице третьего поля формы, в которое пользователь должен ввести отправленный код.

6 Проверка этого поля на пустоту функцией is_not_empty(string $field): bool. Если функция вернула true, то переходим к следующему шагу, если false то возвращаем строку - 'поле для ввода телефона (email) должно быть заполнено'

7. Вызов функции check_code(string $login, string $code): bool. Проверка кода введенного пользователем в поле формы. Проверка происходит с помощью SQL-запроса к базе данных. Если код существует у пользователя с таким логином, то
пользователь успешно авторизуется, иначе возвращается строка, сообщающая, что код неверный и появляется кнопка, предлагающая снова отправить код.